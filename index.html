<!doctype html><html lang="en" class="scroll-smooth"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Training Diverse High-Dimensional Controllers by Scaling Covariance Matrix Adaptation MAP-Annealing</title><link rel="canonical" href="https://scalingcmamae.github.io/"><link rel="alternate" type="application/atom+xml" title="" href="/feed.xml"><meta name="description" content="Supplemental website for the paper 'Training Diverse High-Dimensional Controllers by Scaling Covariance Matrix Adaptation MAP-Annealing'"><meta property="og:title" content="Training Diverse High-Dimensional Controllers by Scaling Covariance Matrix Adaptation MAP-Annealing"><meta property="og:type" content="website"><meta property="og:url" content="https://scalingcmamae.github.io/"><meta property="og:image" content="https://scalingcmamae.github.io/static/scaling-cma-mae-diagram-open-graph.png"><meta property="og:description" content="Supplemental website for the paper 'Training Diverse High-Dimensional Controllers by Scaling Covariance Matrix Adaptation MAP-Annealing'"><meta property="og:image:alt" content="Diagram of our proposed scalable CMA-MAE variants."><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Training Diverse High-Dimensional Controllers by Scaling Covariance Matrix Adaptation MAP-Annealing"><meta name="twitter:description" content="Supplemental website for the paper 'Training Diverse High-Dimensional Controllers by Scaling Covariance Matrix Adaptation MAP-Annealing'"><meta name="twitter:creator" content="btjanaka"><meta name="twitter:image" content="https://scalingcmamae.github.io/static/scaling-cma-mae-diagram-twitter.png"><meta name="twitter:image:alt" content="Diagram of our proposed scalable CMA-MAE variants."><link rel="stylesheet" href="/assets/main.css?9eb22f25f02726be59dba1434e4c48a1"><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel="stylesheet" href="/assets/fontawesome-5.15.4/css/all.min.css"><link rel="stylesheet" href="/assets/academicons-1.9.1/css/academicons.min.css"><link rel="stylesheet" href="/assets/katex-0.15.2/katex.min.css"><script defer="defer" src="/assets/katex-0.15.2/katex.js"></script><script defer="defer" src="/assets/katex-0.15.2/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
            // customised options
            // • auto-render specific keys, e.g.:
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false},
                {left: '\\(', right: '\\)', display: false},
                {left: '\\[', right: '\\]', display: true}
            ],
            // • rendering keys, e.g.:
            throwOnError : false
          });
      });</script><link rel="icon" href="/favicon.ico" sizes="any"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="apple-touch-icon" href="/apple-touch-icon.png"></head><body class="flex flex-col min-h-screen selection:bg-[rgba(192,192,192,0.5)] text-gray-800"><main class="w-full mx-auto"><div class="w-full mx-auto max-w-screen-lg px-4 py-12"><h1 class="text-center font-bold leading-snug text-[2.4rem]">Training Diverse High-Dimensional Controllers by Scaling Covariance Matrix Adaptation MAP-Annealing</h1><div><div class="mx-auto grid border-b-2 border-black border-t-2 max-w-2xl md:grid-cols-2 md:w-full my-6 w-5/6"><a href="https://arxiv.org/abs/2210.02622" title="Full Paper (arXiv)" class="text-center text-lg block font-bold hover:bg-gray-200 hover:underline px-1.5 py-2 text-blue-400 w-full"><i class="pr-1.5 text-2xl ai ai-arxiv" style="color:#000"></i> Full Paper (arXiv) </a><a href="https://github.com/icaros-usc/scaling-cma-mae" title="Code (GitHub)" class="text-center text-lg block font-bold hover:bg-gray-200 hover:underline px-1.5 py-2 text-blue-400 w-full"><i class="pr-1.5 text-2xl fab fa-github" style="color:#000"></i> Code (GitHub) </a><a href="#supplemental-video" title="Supplemental Video" class="text-center text-lg block font-bold hover:bg-gray-200 hover:underline px-1.5 py-2 text-blue-400 w-full"><i class="pr-1.5 text-2xl fa-film fas" style="color:#000"></i> Supplemental Video </a><a href="https://twitter.com/btjanaka/status/1578181058696163329" title="TL;DR (Twitter)" class="text-center text-lg block font-bold hover:bg-gray-200 hover:underline px-1.5 py-2 text-blue-400 w-full"><i class="pr-1.5 text-2xl fab fa-twitter" style="color:#000"></i> TL;DR (Twitter)</a></div><div class="mx-auto grid gap-4 grid-cols-1 lg:grid-cols-3 max-w-screen-lg my-4 sm:gap-2 sm:grid-cols-2"><p class="text-center text-lg"><a href="https://btjanaka.net/">Bryon Tjanaka</a><br><span>University of Southern California</span><br><a class="font-mono" href="mailto:tjanaka@usc.edu">tjanaka@usc.edu</a></p><p class="text-center text-lg"><a href="https://scholar.google.com/citations?user=RqSvzikAAAAJ">Matthew C. Fontaine</a><br><span>University of Southern California</span><br><a class="font-mono" href="mailto:mfontain@usc.edu">mfontain@usc.edu</a></p><p class="text-center text-lg"><a href="https://www.linkedin.com/in/lee-david-haolong">David H. Lee</a><br><span>University of Southern California</span><br><a class="font-mono" href="mailto:dhlee@usc.edu">dhlee@usc.edu</a></p><p class="text-center text-lg"><a href="https://aniruddhakalkar.github.io/">Aniruddha Kalkar</a><br><span>University of Southern California</span><br><a class="font-mono" href="mailto:kalkar@usc.edu">kalkar@usc.edu</a></p><p class="text-center text-lg"><a href="https://stefanosnikolaidis.net/">Stefanos Nikolaidis</a><br><span>University of Southern California</span><br><a class="font-mono" href="mailto:nikolaid@usc.edu">nikolaid@usc.edu</a></p></div></div><div><h2 class="text-center">Abstract</h2><p class="text-lg max-w-screen-md mx-auto my-3">Pre-training a diverse set of robot controllers in simulation has enabled robots to adapt online to damage in robot locomotion tasks. However, finding diverse, high-performing controllers requires specialized hardware and extensive tuning of a large number of hyperparameters. On the other hand, the Covariance Matrix Adaptation MAP-Annealing algorithm, an evolution strategies (ES)-based quality diversity algorithm, does not have these limitations and has been shown to achieve state-of-the-art performance in standard benchmark domains. However, CMA-MAE cannot scale to modern neural network controllers due to its quadratic complexity. We leverage efficient approximation methods in ES to propose three new CMA-MAE variants that scale to very high dimensions. Our experiments show that the variants outperform ES-based baselines in benchmark robotic locomotion tasks, while being comparable with state-of-the-art deep reinforcement learning-based quality diversity algorithms.</p></div><div><h2 class="text-center mb-6 mt-8" id="supplemental-video">Supplemental Video</h2><figure class="w-full mx-auto max-w-screen-md my-3"><video src="/static/scaling-cma-mae-video.mp4" type="video/mp4" class="w-full border-2 border-black rounded-lg" controls muted playsinline preload="auto"></video></figure></div><div><h2 class="text-center mb-4 mt-12" id="algorithm-overview">Algorithm Overview</h2><figure class="w-full mx-auto max-w-screen-md my-3"><img class="w-full" src="static/scaling-cma-mae-diagram.png"><figcaption class="italic mt-4 text-justify">We propose variants of the CMA-MAE algorithm which scale to high-dimensional controllers. The variants maintain a Gaussian search distribution with mean $\bm{\phi}^*$ and approximate covariance matrix $\tilde{\bm{\Sigma}}$. Solutions $\bm{\phi}_i$ sampled from the Gaussian are evaluated and inserted into an archive, where they generate improvement feedback $\Delta_i$ based on their objective value $f(\bm{\phi}_i)$ and a threshold $t_e$ which each archive cell maintains. Finally, the Gaussian is updated with an evolution strategy (ES). Our variants differ from CMA-MAE by selecting scalable ESs, as the CMA-ES used in CMA-MAE has $\Theta(n^2)$ time complexity per sampled solution.</figcaption></figure></div></div></main><script src="/assets/main.js?f086cd8d394be0b0099dea23ffc5bdc1"></script><script src="/assets/vendor.js?3ab9319d52797c4394a2812f925ce048"></script></body></html>